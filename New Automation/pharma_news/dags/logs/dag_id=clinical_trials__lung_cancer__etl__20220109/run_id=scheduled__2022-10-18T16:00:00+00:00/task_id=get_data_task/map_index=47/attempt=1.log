[2022-10-18 18:01:04,075] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: clinical_trials__lung_cancer__etl__20220109.get_data_task scheduled__2022-10-18T16:00:00+00:00 map_index=47 [queued]>
[2022-10-18 18:01:04,083] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: clinical_trials__lung_cancer__etl__20220109.get_data_task scheduled__2022-10-18T16:00:00+00:00 map_index=47 [queued]>
[2022-10-18 18:01:04,085] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-10-18 18:01:04,086] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-10-18 18:01:04,087] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-10-18 18:01:04,094] {taskinstance.py:1377} INFO - Executing <Mapped(_PythonDecoratedOperator): get_data_task> on 2022-10-18 16:00:00+00:00
[2022-10-18 18:01:04,100] {standard_task_runner.py:52} INFO - Started process 2618 to run task
[2022-10-18 18:01:04,104] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'clinical_trials__lung_cancer__etl__20220109', 'get_data_task', 'scheduled__2022-10-18T16:00:00+00:00', '--job-id', '303', '--raw', '--subdir', 'DAGS_FOLDER/process_news_dags.py', '--cfg-path', '/tmp/tmpoyruoeph', '--map-index', '47', '--error-file', '/tmp/tmpqiwtr7rr']
[2022-10-18 18:01:04,106] {standard_task_runner.py:80} INFO - Job 303: Subtask get_data_task
[2022-10-18 18:01:04,120] {logging_mixin.py:115} WARNING - /root/.cache/pypoetry/virtualenvs/***-tXitOD5F-py3.8/lib/python3.8/site-packages/airflow/configuration.py:525 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2022-10-18 18:01:04,156] {task_command.py:370} INFO - Running <TaskInstance: clinical_trials__lung_cancer__etl__20220109.get_data_task scheduled__2022-10-18T16:00:00+00:00 map_index=47 [running]> on host 6cdf6d517dc4
[2022-10-18 18:01:04,199] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=wais@datakimia.com,david@datakimia.com,juanm@datakimia.com,tomas@datakimia.com
AIRFLOW_CTX_DAG_OWNER=atacana
AIRFLOW_CTX_DAG_ID=clinical_trials__lung_cancer__etl__20220109
AIRFLOW_CTX_TASK_ID=get_data_task
AIRFLOW_CTX_EXECUTION_DATE=2022-10-18T16:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-10-18T16:00:00+00:00
[2022-10-18 18:01:04,201] {process_news_dag_factory.py:57} INFO - Extracting data for indication: Lung Cancer, source: clinical_trials, TA: Oncology, keyword: Pembrolizumab 
[2022-10-18 18:01:04,202] {extract.py:30} INFO - Going to extract clinicaltrials data about keyword Pembrolizumab
[2022-10-18 18:01:05,272] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 54 entries, 0 to 53
Data columns (total 13 columns):
 #   Column            Non-Null Count  Dtype         
---  ------            --------------  -----         
 0   title             54 non-null     object        
 1   link              54 non-null     object        
 2   id                54 non-null     object        
 3   published_at      54 non-null     object        
 4   conditions        54 non-null     object        
 5   intervention      54 non-null     object        
 6   publisher         54 non-null     object        
 7   status            54 non-null     object        
 8   source            54 non-null     object        
 9   keyword           54 non-null     object        
 10  indication        54 non-null     object        
 11  therapeutic_area  54 non-null     object        
 12  updated_at        54 non-null     datetime64[ns]
dtypes: datetime64[ns](1), object(12)
memory usage: 5.6+ KB
[2022-10-18 18:01:05,273] {process_news_dag_factory.py:80} INFO - None
[2022-10-18 18:01:05,274] {process_news_dag_factory.py:81} INFO - Writing temp file lung-cancer_clinical-trials_pembrolizumab_20221018-16_df.json
[2022-10-18 18:01:05,281] {python.py:173} INFO - Done. Returned value was: None
[2022-10-18 18:01:05,292] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=clinical_trials__lung_cancer__etl__20220109, task_id=get_data_task, map_index=47, execution_date=20221018T160000, start_date=20221018T180104, end_date=20221018T180105
[2022-10-18 18:01:05,316] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-10-18 18:01:05,400] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
