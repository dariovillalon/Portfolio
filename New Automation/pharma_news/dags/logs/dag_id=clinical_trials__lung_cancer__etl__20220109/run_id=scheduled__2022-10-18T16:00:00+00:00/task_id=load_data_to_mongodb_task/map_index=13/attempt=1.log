[2022-10-18 18:04:29,681] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: clinical_trials__lung_cancer__etl__20220109.load_data_to_mongodb_task scheduled__2022-10-18T16:00:00+00:00 map_index=13 [queued]>
[2022-10-18 18:04:29,691] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: clinical_trials__lung_cancer__etl__20220109.load_data_to_mongodb_task scheduled__2022-10-18T16:00:00+00:00 map_index=13 [queued]>
[2022-10-18 18:04:29,692] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-10-18 18:04:29,693] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-10-18 18:04:29,694] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-10-18 18:04:29,700] {taskinstance.py:1377} INFO - Executing <Mapped(_PythonDecoratedOperator): load_data_to_mongodb_task> on 2022-10-18 16:00:00+00:00
[2022-10-18 18:04:29,704] {standard_task_runner.py:52} INFO - Started process 2929 to run task
[2022-10-18 18:04:29,707] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'clinical_trials__lung_cancer__etl__20220109', 'load_data_to_mongodb_task', 'scheduled__2022-10-18T16:00:00+00:00', '--job-id', '399', '--raw', '--subdir', 'DAGS_FOLDER/process_news_dags.py', '--cfg-path', '/tmp/tmpo18hnulb', '--map-index', '13', '--error-file', '/tmp/tmpdzho7ywv']
[2022-10-18 18:04:29,708] {standard_task_runner.py:80} INFO - Job 399: Subtask load_data_to_mongodb_task
[2022-10-18 18:04:29,719] {logging_mixin.py:115} WARNING - /root/.cache/pypoetry/virtualenvs/***-tXitOD5F-py3.8/lib/python3.8/site-packages/airflow/configuration.py:525 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2022-10-18 18:04:29,746] {task_command.py:370} INFO - Running <TaskInstance: clinical_trials__lung_cancer__etl__20220109.load_data_to_mongodb_task scheduled__2022-10-18T16:00:00+00:00 map_index=13 [running]> on host 6cdf6d517dc4
[2022-10-18 18:04:29,791] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=wais@datakimia.com,david@datakimia.com,juanm@datakimia.com,tomas@datakimia.com
AIRFLOW_CTX_DAG_OWNER=atacana
AIRFLOW_CTX_DAG_ID=clinical_trials__lung_cancer__etl__20220109
AIRFLOW_CTX_TASK_ID=load_data_to_mongodb_task
AIRFLOW_CTX_EXECUTION_DATE=2022-10-18T16:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-10-18T16:00:00+00:00
[2022-10-18 18:04:29,793] {process_news_dag_factory.py:128} INFO - Going to load data from clinical_trials about topic ipilimumab
[2022-10-18 18:04:29,815] {db_helpers.py:35} INFO - Connected successfully!!!
[2022-10-18 18:04:29,820] {_universal.py:476} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container?restype=REDACTED&comp=REDACTED&prefix=REDACTED&delimiter=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4fad0d44-4f0f-11ed-b17f-0242bebc0005'
    'Authorization': 'REDACTED'
No body was attached to the request
[2022-10-18 18:04:30,716] {_universal.py:504} INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e44a6d8f-701e-0054-041c-e3f050000000'
    'x-ms-client-request-id': '4fad0d44-4f0f-11ed-b17f-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 18:04:30 GMT'
[2022-10-18 18:04:30,722] {_universal.py:476} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container/lung-cancer/clinical-trials/20221018/ipilimumab/lung-cancer_clinical-trials_20221018_ipilimumab_NCT05457959.json'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5036d498-4f0f-11ed-b17f-0242bebc0005'
    'Authorization': 'REDACTED'
No body was attached to the request
[2022-10-18 18:04:30,903] {_universal.py:504} INFO - Response status: 206
Response headers:
    'Content-Length': '845'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 18 Oct 2022 18:01:49 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DAB132D44B2A52"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e44a6f2d-701e-0054-061c-e3f050000000'
    'x-ms-client-request-id': '5036d498-4f0f-11ed-b17f-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 18:04:30 GMT'
[2022-10-18 18:04:30,921] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 1 entries, 0 to 0
Data columns (total 13 columns):
 #   Column            Non-Null Count  Dtype 
---  ------            --------------  ----- 
 0   title             1 non-null      object
 1   link              1 non-null      object
 2   id                1 non-null      object
 3   published_at      1 non-null      object
 4   conditions        1 non-null      object
 5   intervention      1 non-null      object
 6   publisher         1 non-null      object
 7   status            1 non-null      object
 8   source            1 non-null      object
 9   keyword           1 non-null      object
 10  indication        1 non-null      object
 11  therapeutic_area  1 non-null      object
 12  updated_at        1 non-null      object
dtypes: object(13)
memory usage: 232.0+ bytes
[2022-10-18 18:04:30,923] {process_news_dag_factory.py:159} INFO - None
[2022-10-18 18:04:30,928] {process_news_dag_factory.py:167} INFO - {'id': 'NCT05457959', 'source': 'clinical_trials', 'therapeutic_area': 'Oncology', 'indication': 'Lung Cancer', 'keyword': 'ipilimumab', 'title': 'Peptide-Pulsed Dendritic Cell Vaccination in Combination With Nivolumab and Ipilimumab for the Treatment of Recurrent and/or Progressive Diffuse Hemispheric Glioma, H3 G34-mutant', 'link': 'https://clinicaltrials.gov/ct2/show/NCT05457959?cond=ipilimumab&sfpd_d=100', 'publisher': 'Jonsson Comprehensive Cancer Center', 'published_at': '2022-07-14T12:00:00.000Z', 'updated_at': '2022-10-18T18:00:21.786Z', 'atacana_team': None, 'category': None, 'priority': None, 'content': None}
[2022-10-18 18:04:32,201] {_universal.py:476} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container/lung-cancer/clinical-trials/20221018/ipilimumab/lung-cancer_clinical-trials_20221018_ipilimumab_NCT05492123.json'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '511872ae-4f0f-11ed-b17f-0242bebc0005'
    'Authorization': 'REDACTED'
No body was attached to the request
[2022-10-18 18:04:32,388] {_universal.py:504} INFO - Response status: 206
Response headers:
    'Content-Length': '646'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 18 Oct 2022 18:01:48 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DAB132D3CF2E94"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e44a75c8-701e-0054-151c-e3f050000000'
    'x-ms-client-request-id': '511872ae-4f0f-11ed-b17f-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 18:04:32 GMT'
[2022-10-18 18:04:32,398] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 1 entries, 0 to 0
Data columns (total 13 columns):
 #   Column            Non-Null Count  Dtype 
---  ------            --------------  ----- 
 0   title             1 non-null      object
 1   link              1 non-null      object
 2   id                1 non-null      object
 3   published_at      1 non-null      object
 4   conditions        1 non-null      object
 5   intervention      1 non-null      object
 6   publisher         1 non-null      object
 7   status            1 non-null      object
 8   source            1 non-null      object
 9   keyword           1 non-null      object
 10  indication        1 non-null      object
 11  therapeutic_area  1 non-null      object
 12  updated_at        1 non-null      object
dtypes: object(13)
memory usage: 232.0+ bytes
[2022-10-18 18:04:32,400] {process_news_dag_factory.py:159} INFO - None
[2022-10-18 18:04:32,403] {process_news_dag_factory.py:167} INFO - {'id': 'NCT05492123', 'source': 'clinical_trials', 'therapeutic_area': 'Oncology', 'indication': 'Lung Cancer', 'keyword': 'ipilimumab', 'title': 'Nivolumab-ipilimumab and Chemoradiation for Cervical Cancer', 'link': 'https://clinicaltrials.gov/ct2/show/NCT05492123?cond=ipilimumab&sfpd_d=100', 'publisher': 'Hospital Israelita Albert Einstein;   Bristol-Myers Squibb;   Brava', 'published_at': '2022-08-08T12:00:00.000Z', 'updated_at': '2022-10-18T18:00:21.786Z', 'atacana_team': None, 'category': None, 'priority': None, 'content': None}
[2022-10-18 18:04:32,625] {_universal.py:476} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container/lung-cancer/clinical-trials/20221018/ipilimumab/lung-cancer_clinical-trials_20221018_ipilimumab_NCT05498792.json'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '51592e8e-4f0f-11ed-b17f-0242bebc0005'
    'Authorization': 'REDACTED'
No body was attached to the request
[2022-10-18 18:04:32,806] {_universal.py:504} INFO - Response status: 206
Response headers:
    'Content-Length': '594'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 18 Oct 2022 18:01:49 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DAB132D42E7EB9"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e44a77f1-701e-0054-131c-e3f050000000'
    'x-ms-client-request-id': '51592e8e-4f0f-11ed-b17f-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 18:04:32 GMT'
[2022-10-18 18:04:32,811] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 1 entries, 0 to 0
Data columns (total 13 columns):
 #   Column            Non-Null Count  Dtype 
---  ------            --------------  ----- 
 0   title             1 non-null      object
 1   link              1 non-null      object
 2   id                1 non-null      object
 3   published_at      1 non-null      object
 4   conditions        1 non-null      object
 5   intervention      1 non-null      object
 6   publisher         1 non-null      object
 7   status            1 non-null      object
 8   source            1 non-null      object
 9   keyword           1 non-null      object
 10  indication        1 non-null      object
 11  therapeutic_area  1 non-null      object
 12  updated_at        1 non-null      object
dtypes: object(13)
memory usage: 232.0+ bytes
[2022-10-18 18:04:32,813] {process_news_dag_factory.py:159} INFO - None
[2022-10-18 18:04:32,815] {process_news_dag_factory.py:167} INFO - {'id': 'NCT05498792', 'source': 'clinical_trials', 'therapeutic_area': 'Oncology', 'indication': 'Lung Cancer', 'keyword': 'ipilimumab', 'title': 'Study of CBL0137 in Combination With Ipilimumab and Nivolumab Therapy in Melanoma', 'link': 'https://clinicaltrials.gov/ct2/show/NCT05498792?cond=ipilimumab&sfpd_d=100', 'publisher': 'Fox Chase Cancer Center;   Incuron', 'published_at': '2022-08-12T12:00:00.000Z', 'updated_at': '2022-10-18T18:00:21.786Z', 'atacana_team': None, 'category': None, 'priority': None, 'content': None}
[2022-10-18 18:04:33,036] {_universal.py:476} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container/lung-cancer/clinical-trials/20221018/ipilimumab/lung-cancer_clinical-trials_20221018_ipilimumab_NCT05501054.json'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5197cae0-4f0f-11ed-b17f-0242bebc0005'
    'Authorization': 'REDACTED'
No body was attached to the request
[2022-10-18 18:04:33,220] {_universal.py:504} INFO - Response status: 206
Response headers:
    'Content-Length': '633'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 18 Oct 2022 18:01:49 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DAB132D4096FF1"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e44a79bf-701e-0054-431c-e3f050000000'
    'x-ms-client-request-id': '5197cae0-4f0f-11ed-b17f-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 18:04:33 GMT'
[2022-10-18 18:04:33,226] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 1 entries, 0 to 0
Data columns (total 13 columns):
 #   Column            Non-Null Count  Dtype 
---  ------            --------------  ----- 
 0   title             1 non-null      object
 1   link              1 non-null      object
 2   id                1 non-null      object
 3   published_at      1 non-null      object
 4   conditions        1 non-null      object
 5   intervention      1 non-null      object
 6   publisher         1 non-null      object
 7   status            1 non-null      object
 8   source            1 non-null      object
 9   keyword           1 non-null      object
 10  indication        1 non-null      object
 11  therapeutic_area  1 non-null      object
 12  updated_at        1 non-null      object
dtypes: object(13)
memory usage: 232.0+ bytes
[2022-10-18 18:04:33,228] {process_news_dag_factory.py:159} INFO - None
[2022-10-18 18:04:33,230] {process_news_dag_factory.py:167} INFO - {'id': 'NCT05501054', 'source': 'clinical_trials', 'therapeutic_area': 'Oncology', 'indication': 'Lung Cancer', 'keyword': 'ipilimumab', 'title': 'Phase 1b/2 Trial of Ipilimumab, Nivolumab, and Ciforadenant (Adenosine A2a Receptor Antagonist) in First-line Advanced Renal Cell Carcinoma.', 'link': 'https://clinicaltrials.gov/ct2/show/NCT05501054?cond=ipilimumab&sfpd_d=100', 'publisher': 'M.D. Anderson Cancer Center', 'published_at': '2022-08-15T12:00:00.000Z', 'updated_at': '2022-10-18T18:00:21.786Z', 'atacana_team': None, 'category': None, 'priority': None, 'content': None}
[2022-10-18 18:04:33,452] {_universal.py:476} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container/lung-cancer/clinical-trials/20221018/ipilimumab/lung-cancer_clinical-trials_20221018_ipilimumab_NCT05504642.json'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '51d74db4-4f0f-11ed-b17f-0242bebc0005'
    'Authorization': 'REDACTED'
No body was attached to the request
[2022-10-18 18:04:33,639] {_universal.py:504} INFO - Response status: 206
Response headers:
    'Content-Length': '809'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 18 Oct 2022 18:01:48 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DAB132D3ECEB63"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e44a7bb9-701e-0054-291c-e3f050000000'
    'x-ms-client-request-id': '51d74db4-4f0f-11ed-b17f-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 18:04:33 GMT'
[2022-10-18 18:04:33,646] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 1 entries, 0 to 0
Data columns (total 13 columns):
 #   Column            Non-Null Count  Dtype 
---  ------            --------------  ----- 
 0   title             1 non-null      object
 1   link              1 non-null      object
 2   id                1 non-null      object
 3   published_at      1 non-null      object
 4   conditions        1 non-null      object
 5   intervention      1 non-null      object
 6   publisher         1 non-null      object
 7   status            1 non-null      object
 8   source            1 non-null      object
 9   keyword           1 non-null      object
 10  indication        1 non-null      object
 11  therapeutic_area  1 non-null      object
 12  updated_at        1 non-null      object
dtypes: object(13)
memory usage: 232.0+ bytes
[2022-10-18 18:04:33,647] {process_news_dag_factory.py:159} INFO - None
[2022-10-18 18:04:33,652] {process_news_dag_factory.py:167} INFO - {'id': 'NCT05504642', 'source': 'clinical_trials', 'therapeutic_area': 'Oncology', 'indication': 'Lung Cancer', 'keyword': 'ipilimumab', 'title': 'Chemo-radio-immunotherapy With Nivolumab and Ipilimumab Treatment in Locally Advanced Cervical Cancer Patients', 'link': 'https://clinicaltrials.gov/ct2/show/NCT05504642?cond=ipilimumab&sfpd_d=100', 'publisher': 'Universitätsklinikum Köln;   ZKS Köln', 'published_at': '2022-08-17T12:00:00.000Z', 'updated_at': '2022-10-18T18:00:21.786Z', 'atacana_team': None, 'category': None, 'priority': None, 'content': None}
[2022-10-18 18:04:33,868] {python.py:173} INFO - Done. Returned value was: None
[2022-10-18 18:04:33,878] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=clinical_trials__lung_cancer__etl__20220109, task_id=load_data_to_mongodb_task, map_index=13, execution_date=20221018T160000, start_date=20221018T180429, end_date=20221018T180433
[2022-10-18 18:04:33,927] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-10-18 18:04:33,953] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
