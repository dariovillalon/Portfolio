[2022-10-18 22:03:47,003] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: clinical_trials__lung_cancer__etl__20220109.load_data_to_blob_storage_task scheduled__2022-10-18T20:00:00+00:00 map_index=57 [queued]>
[2022-10-18 22:03:47,033] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: clinical_trials__lung_cancer__etl__20220109.load_data_to_blob_storage_task scheduled__2022-10-18T20:00:00+00:00 map_index=57 [queued]>
[2022-10-18 22:03:47,048] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-10-18 22:03:47,053] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-10-18 22:03:47,072] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-10-18 22:03:47,081] {taskinstance.py:1377} INFO - Executing <Mapped(_PythonDecoratedOperator): load_data_to_blob_storage_task> on 2022-10-18 20:00:00+00:00
[2022-10-18 22:03:47,089] {standard_task_runner.py:52} INFO - Started process 6840 to run task
[2022-10-18 22:03:47,092] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'clinical_trials__lung_cancer__etl__20220109', 'load_data_to_blob_storage_task', 'scheduled__2022-10-18T20:00:00+00:00', '--job-id', '866', '--raw', '--subdir', 'DAGS_FOLDER/process_news_dags.py', '--cfg-path', '/tmp/tmpxevcyt95', '--map-index', '57', '--error-file', '/tmp/tmpxvd7b8_a']
[2022-10-18 22:03:47,093] {standard_task_runner.py:80} INFO - Job 866: Subtask load_data_to_blob_storage_task
[2022-10-18 22:03:47,104] {logging_mixin.py:115} WARNING - /root/.cache/pypoetry/virtualenvs/***-tXitOD5F-py3.8/lib/python3.8/site-packages/airflow/configuration.py:525 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2022-10-18 22:03:47,140] {task_command.py:370} INFO - Running <TaskInstance: clinical_trials__lung_cancer__etl__20220109.load_data_to_blob_storage_task scheduled__2022-10-18T20:00:00+00:00 map_index=57 [running]> on host 6cdf6d517dc4
[2022-10-18 22:03:47,194] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=wais@datakimia.com,david@datakimia.com,juanm@datakimia.com,tomas@datakimia.com
AIRFLOW_CTX_DAG_OWNER=atacana
AIRFLOW_CTX_DAG_ID=clinical_trials__lung_cancer__etl__20220109
AIRFLOW_CTX_TASK_ID=load_data_to_blob_storage_task
AIRFLOW_CTX_EXECUTION_DATE=2022-10-18T20:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-10-18T20:00:00+00:00
[2022-10-18 22:03:47,196] {process_news_dag_factory.py:105} INFO - Reading temp file: lung-cancer_clinical-trials_roche_20221018-20_df.json
[2022-10-18 22:03:47,211] {helpers.py:114} INFO - Going to save clinical_trials data..
[2022-10-18 22:03:47,212] {helpers.py:115} INFO -                                                title  ...                  updated_at
0  A Real-World Study to Gain Clinical Insights I...  ...  2022-10-18 22:01:14.022000
1                 R21 Roche: 3-Way Tau Tracers in AD  ...  2022-10-18 22:01:14.022000

[2 rows x 13 columns]
[2022-10-18 22:03:47,221] {helpers.py:116} INFO - Index(['title', 'link', 'id', 'published_at', 'conditions', 'intervention',
       'publisher', 'status', 'source', 'keyword', 'indication',
       'therapeutic_area', 'updated_at'],
      dtype='object')
[2022-10-18 22:03:47,226] {_universal.py:473} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container/lung-cancer/clinical-trials/20221018/roche/lung-cancer_clinical-trials_20221018_roche_NCT05476926.json'
Request method: 'PUT'
Request headers:
    'Content-Length': '620'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bd5b6360-4f30-11ed-a534-0242bebc0005'
    'Authorization': 'REDACTED'
A body is sent with the request
[2022-10-18 22:03:47,971] {_universal.py:504} INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 18 Oct 2022 22:03:48 GMT'
    'ETag': '"0x8DAB154A207EBC7"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e1cdc9fa-e01e-0056-233d-e34ee8000000'
    'x-ms-client-request-id': 'bd5b6360-4f30-11ed-a534-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 22:03:47 GMT'
[2022-10-18 22:03:47,974] {_universal.py:473} INFO - Request URL: 'https://atacananews.blob.core.windows.net/atacana-blob-container/lung-cancer/clinical-trials/20221018/roche/lung-cancer_clinical-trials_20221018_roche_NCT05464368.json'
Request method: 'PUT'
Request headers:
    'Content-Length': '535'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.13.1 Python/3.8.15 (Linux-5.10.124-linuxkit-aarch64-with-glibc2.17)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bdcd7d88-4f30-11ed-a534-0242bebc0005'
    'Authorization': 'REDACTED'
A body is sent with the request
[2022-10-18 22:03:48,160] {_universal.py:504} INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Content-MD5': 'REDACTED'
    'Last-Modified': 'Tue, 18 Oct 2022 22:03:48 GMT'
    'ETag': '"0x8DAB154A2249755"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e1cdcb74-e01e-0056-0d3d-e34ee8000000'
    'x-ms-client-request-id': 'bdcd7d88-4f30-11ed-a534-0242bebc0005'
    'x-ms-version': 'REDACTED'
    'x-ms-content-crc64': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'Date': 'Tue, 18 Oct 2022 22:03:48 GMT'
[2022-10-18 22:03:48,175] {python.py:173} INFO - Done. Returned value was: None
[2022-10-18 22:03:48,201] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=clinical_trials__lung_cancer__etl__20220109, task_id=load_data_to_blob_storage_task, map_index=57, execution_date=20221018T200000, start_date=20221018T220347, end_date=20221018T220348
[2022-10-18 22:03:48,292] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-10-18 22:03:48,348] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
